{% extends 'base.html.twig' %}


{% block title %}{{ sharable.name }} : Contact{% endblock %}

{% block content %}

{% import 'macros/breadcrumbs.html.twig' as breadcrumbs %}

{{ breadcrumbs.render([
    {'url': url('sharable'), 'text': 'Sharables'},
    {'url': url('sharable_show', {id: sharable.id}), 'text': sharable.name},
    {'text': 'Contact'},
]) }}

<h1>Contacts</h1>

<h3>Sharable contacts</h3>


{% for sharableContact in sharable.sharableContacts %}

    <div class="card mb-3">

        <div class="card-header d-flex justify-content-between align-items-center">

            <h4 class="card-title">
                {{ sharableContact.type }} : 
                {{ sharableContact.content }}
            </h4>
        </div>

        <div class="card-body">
            {{ sharableContact.info }}
        </div>
    </div>


{% endfor %}

{% if is_granted('edit', sharable) %}
<a class="btn btn-success" href="{{ path('sharable_contact_add', {id: sharable.id}) }}">add new contact</a>
{% endif %}


<h3>Managers contacts</h3>

{% for manage in sharable.managedBy %}

{% if manage.contactable or is_granted('edit', sharable) %}

    <div class="card mb-3">

        <div class="card-header d-flex justify-content-between align-items-center">

            <h4 class="card-title">
                {{ manage.user.username }}
            </h4>

            <span>
            {% if manage.contactable %}
                <span class="badge badge-success" >contactable</span>
            {% else %}
                <span class="badge badge-danger" >uncontactable</span>
            {% endif %}
            </span>
        </div>

        <div class="card-body">

        {% if is_granted('edit', manage.user) %}
        
            <a class="btn btn-primary" href="">
                {{ manage.contactable ? 'uncontactalbe' : 'contactable' }}
            </a>
        {% endif %}

        <ul>
        {% for userContact in manage.user.userContacts %}
                <li>{{userContact.type}} : {{userContact.content}}</li>
        {% endfor %}
        </ul>
    
        </div>

    </div>

{% endif %}

{% endfor %}

{% endblock %}